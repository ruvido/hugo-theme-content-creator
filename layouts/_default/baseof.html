<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}" data-theme="light">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
    <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    
    <!-- SEO and Social Media Meta Tags -->
    <meta name="author" content="{{ .Site.Params.author.name | default .Site.Title }}">
    <meta property="og:title" content="{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}">
    <meta property="og:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
    <meta property="og:url" content="{{ .Permalink }}">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ if .Title }}{{ .Title }} | {{ end }}{{ .Site.Title }}">
    <meta name="twitter:description" content="{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}">
    <meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="language" content="{{ .Site.Language.Lang }}">
    <meta name="rating" content="general">
    <meta name="distribution" content="global">
    <meta name="revisit-after" content="7 days">
    <meta name="generator" content="Hugo {{ hugo.Version }}">
    
    <!-- Open Graph Protocol -->
    <meta property="og:locale" content="{{ .Site.Language.Lang }}_{{ upper .Site.Language.Lang }}">
    <meta property="og:site_name" content="{{ .Site.Title }}">
    {{ with .Site.Params.social.facebook }}<meta property="fb:admins" content="{{ . }}">{{ end }}
    
    <!-- Twitter Card -->
    <meta name="twitter:creator" content="{{ with .Site.Params.social.twitter }}@{{ . }}{{ end }}">
    <meta name="twitter:site" content="{{ with .Site.Params.social.twitter }}@{{ . }}{{ end }}">
    {{ if .IsPage }}
    <meta name="article:author" content="{{ .Params.author | default .Site.Author.name }}">
    <meta name="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05-07:00" }}">
    <meta name="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" }}">
    {{ range .Params.tags }}<meta name="article:tag" content="{{ . }}">{{ end }}
    {{ end }}
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ .Permalink }}">
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "{{ if .IsPage }}Article{{ else }}WebSite{{ end }}",
      "name": "{{ if .Title }}{{ .Title }}{{ else }}{{ .Site.Title }}{{ end }}",
      "description": "{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}",
      "url": "{{ .Permalink }}",
      "inLanguage": "{{ .Site.Language.Lang }}",
      {{ if not .IsPage }}
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "{{ .Site.BaseURL }}search?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      },
      {{ end }}
      "publisher": {
        "@type": "{{ if .Site.Author.name }}Person{{ else }}Organization{{ end }}",
        "name": "{{ .Site.Params.author.name | default .Site.Title }}"{{ with .Site.Params.social.website }},
        "url": "{{ . }}"{{ end }}
      }{{ if .IsPage }},
      "headline": "{{ .Title }}",
      "datePublished": "{{ .Date.Format "2006-01-02T15:04:05-07:00" }}",
      "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" }}",
      "wordCount": {{ .WordCount }},
      "author": {
        "@type": "Person", 
        "name": "{{ .Params.author | default .Site.Params.author.name }}"
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ .Permalink }}"
      }{{ end }}
    }
    </script>
    
    <!-- Performance optimized - minimal external requests -->
    <meta name="theme-color" content="#2563eb">
    <meta name="color-scheme" content="light dark">
    
    <!-- Theme script - prevent FOUC -->
    <script>
        (function() {
            try {
                const savedTheme = localStorage.getItem('theme');
                const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                const theme = savedTheme || systemTheme;
                document.documentElement.setAttribute('data-theme', theme);
            } catch(e) {
                document.documentElement.setAttribute('data-theme', 'light');
            }
        })();
    </script>
    
    <!-- Prevent FOUC (Flash of Unstyled Content) - Theme Detection -->
    <script>
    (function() {
      try {
        const stored = localStorage.getItem('theme-preference');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = stored && (stored === 'light' || stored === 'dark') ? stored : (prefersDark ? 'dark' : 'light');
        
        if (theme === 'dark') {
          document.documentElement.setAttribute('data-theme', 'dark');
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0f172a');
        }
      } catch (e) {
        // Fallback: do nothing and stay with light theme
      }
    })();
    </script>
    
    <!-- System fonts for instant loading -->
    <style>
    @font-face {
      font-family: 'Inter Fallback';
      src: local('system-ui'), local('-apple-system'), local('BlinkMacSystemFont'), local('Segoe UI'), local('Roboto'), local('Helvetica'), local('Arial'), local('sans-serif');
      font-display: swap;
    }
    </style>
    
    <!-- Critical CSS inline -->
    {{ $css := resources.Get "css/main.css" | resources.Minify }}
    <link rel="stylesheet" href="{{ $css.Permalink }}">
    
    
</head>
<body>
    {{ partial "header.html" . }}
    
    <main id="main">
        {{ block "main" . }}{{ end }}
    </main>
    
    {{ partial "footer.html" . }}
    
    <!-- Critical scripts - optimized loading -->
    {{ $js := resources.Get "js/main.js" | resources.Minify }}
    <script src="{{ $js.Permalink }}" async defer></script>
</body>
</html>