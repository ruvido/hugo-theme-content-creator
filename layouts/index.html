{{ define "main" }}

<!-- Hero Section with CTA -->
<section class="hero" role="banner" aria-labelledby="hero-title">
  <div class="container">
    {{ $cta_type := .Site.Params.cta_type | default "newsletter" }}
    
    {{ if eq $cta_type "newsletter" }}
      <h1 id="hero-title" class="hero-title">{{ i18n "hero_newsletter_title" }}</h1>
      <p class="hero-description">{{ i18n "hero_newsletter_description" }}</p>
      <div class="hero-cta">
        <a href="#newsletter-signup" class="btn btn-primary btn-large" aria-label="Iscriviti gratuitamente alla newsletter">{{ i18n "cta_newsletter_subscribe" }}</a>
        <a href="/articles/" class="btn btn-secondary btn-large" aria-label="Naviga nella sezione articoli">{{ i18n "cta_read_articles" }}</a>
      </div>
    {{ else if eq $cta_type "community" }}
      <h1 id="hero-title" class="hero-title">{{ i18n "hero_community_title" }}</h1>
      <p class="hero-description">{{ i18n "hero_community_description" }}</p>
      <div class="hero-cta">
        <a href="#community-join" class="btn btn-primary btn-large" aria-label="Unisciti alla community dei creator">{{ i18n "cta_join_community" }}</a>
        <a href="/community/" class="btn btn-secondary btn-large" aria-label="Scopri di più sulla community">{{ i18n "cta_discover_more" }}</a>
      </div>
    {{ else }}
      <h1 id="hero-title" class="hero-title">{{ i18n "hero_creator_title" }}</h1>
      <p class="hero-description">{{ i18n "hero_creator_description" }}</p>
      <div class="hero-cta">
        <a href="#start-creating" class="btn btn-primary btn-large" aria-label="Inizia il tuo percorso da content creator">{{ i18n "cta_start_creating" }}</a>
        <a href="/about/" class="btn btn-secondary btn-large" aria-label="Scopri chi sono e la mia storia">{{ i18n "cta_about_me" }}</a>
      </div>
    {{ end }}
  </div>
</section>

<!-- Featured Content -->
{{ $featured := where .Site.Pages "Params.featured" true }}
{{ if $featured }}
<section class="featured" aria-labelledby="featured-heading">
  <div class="container">
    <h2 id="featured-heading" class="section-subtitle">{{ i18n "featured" }}</h2>
    
    <div class="featured-grid">
      {{ range first 3 $featured }}
        <article class="featured-card" role="article">
          <div class="featured-header">
            {{ $contentType := .Type }}
            {{ if eq $contentType "articles" }}
              <span class="featured-badge badge-article">{{ i18n "badge_article" }}</span>
            {{ else if eq $contentType "newsletters" }}
              <span class="featured-badge badge-newsletter">Newsletter</span>
            {{ else if eq $contentType "podcasts" }}
              <span class="featured-badge badge-podcast">{{ i18n "badge_podcast" }}</span>
            {{ else if eq $contentType "videos" }}
              <span class="featured-badge badge-video">{{ i18n "badge_video" }}</span>
            {{ else }}
              <span class="featured-badge badge-article">Speciale</span>
            {{ end }}
          </div>
          
          <h3 class="featured-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h3>
          
          <div class="featured-meta">
            {{ with .Params.author }}
              <span class="featured-author">{{ . }}</span>
            {{ end }}
            {{ with .Params.duration }}
              <span class="featured-duration">{{ . }}</span>
            {{ end }}
            {{ if or .Params.author .Params.duration }} · {{ end }}
            <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2 January 2006" }}</time>
            {{ if .Site.Params.show_reading_time }}
              {{ with .ReadingTime }}
                · {{ . }} min
              {{ end }}
            {{ end }}
          </div>
          
          <div class="featured-preview">
            {{ .Summary | plainify | truncate 180 }}
          </div>
        </article>
      {{ end }}
    </div>
    
    <div class="featured-link" style="text-align: center; margin-top: var(--space-2xl);">
      <a href="/featured/" class="btn btn-secondary">Vedi tutti i contenuti in evidenza →</a>
    </div>
  </div>
</section>
{{ end }}

<!-- Latest Content by Type -->
<section class="content-sections" style="padding: var(--space-4xl) 0;">
  <div class="container">
    
    <!-- Latest Articles -->
    {{ $articles := where (where .Site.Pages "Type" "articles") "Kind" "page" }}
    {{ if $articles }}
    <div class="content-section" style="margin-bottom: var(--space-4xl);">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-2xl);">
        <h3 class="section-subtitle">{{ i18n "latest_articles" }}</h3>
        <a href="/articles/" class="btn btn-secondary">Vedi tutti →</a>
      </div>
      
      {{ range first 1 $articles }}
        <article class="latest-card" role="article">
          <div class="latest-header">
            <span class="content-badge badge-article">{{ i18n "badge_article" }}</span>
            <div class="latest-meta">
              {{ with .Params.author }}
                <span class="latest-author">{{ . }}</span> · 
              {{ end }}
              <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2 January 2006" }}</time>
              {{ if .Site.Params.show_reading_time }}
                {{ with .ReadingTime }}
                  · {{ . }} min lettura
                {{ end }}
              {{ end }}
            </div>
          </div>
          
          <h3 class="latest-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h3>
          
          <div class="latest-preview">
            {{ .Summary | plainify | truncate 300 }}
          </div>
          
          <div class="latest-action">
            <a href="{{ .Permalink }}" class="btn btn-primary">Leggi articolo →</a>
          </div>
        </article>
      {{ end }}
    </div>
    {{ end }}
    
    <!-- Latest Newsletter -->
    {{ $newsletters := where (where .Site.Pages "Type" "newsletters") "Kind" "page" }}
    {{ if $newsletters }}
    <div class="content-section" style="margin-bottom: var(--space-4xl);">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-2xl);">
        <h3 class="section-subtitle">{{ i18n "latest_newsletters" }}</h3>
        <a href="/newsletters/" class="btn btn-secondary">Vedi tutte →</a>
      </div>
      
      {{ range first 1 $newsletters }}
        <article class="latest-card" role="article">
          <div class="latest-header">
            <span class="content-badge badge-newsletter">{{ i18n "newsletter_number" }}{{ .Params.newsletter_number | default "1" }}</span>
            <div class="latest-meta">
              {{ with .Params.author }}
                <span class="latest-author">{{ . }}</span> · 
              {{ end }}
              <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2 January 2006" }}</time>
            </div>
          </div>
          
          <h3 class="latest-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h3>
          
          <div class="latest-preview">
            {{ .Summary | plainify | truncate 300 }}
          </div>
          
          <div class="latest-action">
            <a href="{{ .Permalink }}" class="btn btn-primary">Leggi newsletter →</a>
          </div>
        </article>
      {{ end }}
    </div>
    {{ end }}
    
    <!-- Latest Podcasts -->
    {{ $podcasts := where (where .Site.Pages "Type" "podcasts") "Kind" "page" }}
    {{ if $podcasts }}
    <div class="content-section">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-2xl);">
        <h3 class="section-subtitle">{{ i18n "latest_podcasts" }}</h3>
        <a href="/podcasts/" class="btn btn-secondary">Ascolta tutti →</a>
      </div>
      
      {{ range first 1 $podcasts }}
        <article class="latest-card" role="article">
          <div class="latest-header">
            <span class="content-badge badge-podcast">Episodio #{{ .Params.episode_number | default "1" }}</span>
            <div class="latest-meta">
              {{ with .Params.duration }}
                <span class="featured-duration">{{ . }}</span> · 
              {{ end }}
              <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2 January 2006" }}</time>
            </div>
          </div>
          
          <h3 class="latest-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h3>
          
          <div class="latest-preview">
            {{ .Summary | plainify | truncate 300 }}
          </div>
          
          <div class="latest-action">
            <a href="{{ .Permalink }}" class="btn btn-primary">Ascolta episodio →</a>
          </div>
        </article>
      {{ end }}
    </div>
    {{ end }}
  </div>
</section>

<!-- Testimonials Section -->
{{ if .Site.Data.testimonials }}
<section class="testimonials" aria-labelledby="testimonials-heading">
  <div class="container">
    <h2 id="testimonials-heading" class="section-subtitle">{{ i18n "what_people_say" }}</h2>
    
    <div class="grid grid-3">
      {{ range .Site.Data.testimonials }}
        <div class="testimonial-card">
          <blockquote class="testimonial-quote">"{{ .quote }}"</blockquote>
          <div class="testimonial-author">{{ .name }}</div>
          <div class="testimonial-role">{{ .role }}</div>
        </div>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}

<!-- Newsletter Signup CTA -->
{{ if eq (.Site.Params.cta_type | default "newsletter") "newsletter" }}
<section id="newsletter-signup" style="padding: var(--space-4xl) 0; background: linear-gradient(135deg, var(--color-brand), var(--color-accent));">
  <div class="container" style="text-align: center; color: white;">
    <h2 style="color: white; margin-bottom: var(--space-lg);">Non Perdere Nessun Aggiornamento</h2>
    <p style="font-size: 1.25rem; margin-bottom: var(--space-2xl); opacity: 0.9;">
      Ricevi contenuti esclusivi, consigli pratici e le ultime novità direttamente nella tua inbox.
    </p>
    
    <form action="#" method="post" style="max-width: 500px; margin: 0 auto; display: flex; gap: var(--space-md); flex-wrap: wrap; min-height: 56px;" aria-label="Modulo iscrizione newsletter" role="form">
      <label for="newsletter-email" class="sr-only">Indirizzo email per la newsletter</label>
      <input type="email" id="newsletter-email" placeholder="La tua email" required aria-label="Inserisci il tuo indirizzo email" 
             style="flex: 1; padding: var(--space-md) var(--space-lg); border: none; border-radius: var(--border-radius); font-size: 1rem; min-width: 250px; height: 56px;">
      <button type="submit" class="btn btn-secondary" style="background: white; color: var(--color-brand); border: none; font-weight: var(--font-weight-bold); height: 56px;" aria-label="Iscriviti alla newsletter">
        Iscriviti Gratis
      </button>
    </form>
    
    <p style="font-size: 0.875rem; margin-top: var(--space-md); opacity: 0.8;">
      Niente spam, solo contenuti di qualità. Cancellati quando vuoi.
    </p>
  </div>
</section>
{{ end }}

{{ end }}